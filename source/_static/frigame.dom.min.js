!function(t,i){"use strict";var r={};i.support={ieFilter:!1,rgba:Modernizr.rgba,svg:Modernizr.svg},Modernizr.opacity&&(i.support.opacity=Modernizr.prefixed("opacity")),Modernizr.csstransforms&&(i.support.transformFunction=Modernizr.prefixed("transform"),i.support.transformOrigin=Modernizr.prefixed("transformOrigin")),Modernizr.backgroundsize&&(i.support.backgroundsize=Modernizr.prefixed("backgroundSize")),Modernizr.borderradius&&(i.support.borderTopLeftRadius=Modernizr.prefixed("borderTopLeftRadius"),i.support.borderTopRightRadius=Modernizr.prefixed("borderTopRightRadius"),i.support.borderBottomRightRadius=Modernizr.prefixed("borderBottomRightRadius"),i.support.borderBottomLeftRadius=Modernizr.prefixed("borderBottomLeftRadius")),Modernizr.backgroundblendmode&&(i.support.mixBlendMode=Modernizr.prefixed("mixBlendMode")),Modernizr.cssmask&&(i.support.maskImage=Modernizr.prefixed("maskImage"),i.support.maskSize=Modernizr.prefixed("maskSize")),i.nextGradientId=0,t.extend(i.PGradient,{initDOM:function(){var t,r,e,o,s,a,n,d,p,h,g=this.startColor,l=this.endColor,m=i.support;1===g.a?this.solid_color="rgb("+String(g.r)+","+String(g.g)+","+String(g.b)+")":m.rgba?this.solid_color=this.startColorStr:this.solid_color="rgb("+String(g.r)+","+String(g.g)+","+String(g.b)+")",g===l?1===g.a?this.css_options={"background-color":"rgb("+String(g.r)+","+String(g.g)+","+String(g.b)+")"}:m.rgba?this.css_options={"background-color":this.startColorStr}:m.ieFilter?(t="0"+Math.round(255*g.a).toString(16).toUpperCase(),r="0"+g.r.toString(16).toUpperCase(),e="0"+g.g.toString(16).toUpperCase(),o="0"+g.b.toString(16).toUpperCase(),s="#"+t.slice(t.length-2)+r.slice(r.length-2)+e.slice(e.length-2)+o.slice(o.length-2),this.ie_filter='progid:DXImageTransform.Microsoft.Gradient(GradientType=0,startColorstr="'+s+'",endColorstr="'+s+'")'):this.css_options={"background-color":"rgb("+String(g.r)+","+String(g.g)+","+String(g.b)+")"}:m.svg?(s="rgb("+String(g.r)+","+String(g.g)+","+String(g.b)+")",a="rgb("+String(l.r)+","+String(l.g)+","+String(l.b)+")",this.type===i.GRADIENT_HORIZONTAL?(d=100,p=0):(d=0,p=100),h='<svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 1 1" preserveAspectRatio="none"><defs><linearGradient id="friGameGradient'+String(i.nextGradientId)+'" gradientUnits="userSpaceOnUse" x1="0%" y1="0%" x2="'+String(d)+'%" y2="'+String(p)+'%"><stop offset="0%" stop-color="'+s+'" stop-opacity="'+String(g.a)+'" /><stop offset="100%" stop-color="'+a+'" stop-opacity="'+String(l.a)+'" /></linearGradient></defs><rect x="0" y="0" width="1" height="1" fill="url(#friGameGradient'+String(i.nextGradientId)+')" /></svg>',i.nextGradientId+=1,this.css_options={"background-image":'url("data:image/svg+xml;base64,'+btoa(h)+'")'},m.backgroundsize&&(this.css_options[m.backgroundsize]="100% 100%")):m.ieFilter?(t="0"+Math.round(255*g.a).toString(16).toUpperCase(),r="0"+g.r.toString(16).toUpperCase(),e="0"+g.g.toString(16).toUpperCase(),o="0"+g.b.toString(16).toUpperCase(),s="#"+t.slice(t.length-2)+r.slice(r.length-2)+e.slice(e.length-2)+o.slice(o.length-2),t="0"+Math.round(255*l.a).toString(16).toUpperCase(),r="0"+l.r.toString(16).toUpperCase(),e="0"+l.g.toString(16).toUpperCase(),o="0"+l.b.toString(16).toUpperCase(),a="#"+t.slice(t.length-2)+r.slice(r.length-2)+e.slice(e.length-2)+o.slice(o.length-2),n=this.type===i.GRADIENT_HORIZONTAL?1:0,this.ie_filter="progid:DXImageTransform.Microsoft.Gradient(GradientType="+n+',startColorstr="'+s+'",endColorstr="'+a+'")'):this.css_options={"background-color":this.solid_color},this.dom_initialized=!0},getBackground:function(i,r,e){var o=!1;return this.dom_initialized||this.initDOM(),this.css_options&&t.extend(r,this.css_options),this.ie_filter&&(e.gradient=this.ie_filter,o=!0),o},getSolidColor:function(){return this.dom_initialized||this.initDOM(),this.solid_color}}),t.extend(i.PAnimation,{getBackground:function(t,r,e){var o=i.support,s=!1,a=this.options.frameset[0].imageURL;return t===i.BACKGROUND_STRETCHED?o.backgroundsize?(r["background-image"]='url("'+a+'")',r[o.backgroundsize]="100% 100%"):o.ieFilter?(e.image='progid:DXImageTransform.Microsoft.AlphaImageLoader(src="'+a+'",sizingMethod="scale")',s=!0):r["background-image"]='url("'+a+'")':r["background-image"]='url("'+a+'")',s},getMask:function(t,r,e){var o=i.support,s=this.options.frameset[0].imageURL;return o.maskImage&&(r[o.maskImage]='url("'+s+'")',t===i.MASK_STRETCHED&&(r[o.maskSize]="100% 100%")),!1}}),t.extend(i.PBaseSprite,{transform:function(t,i,r){var e="";return t&&(e+="rotate("+String(t)+"rad)"),1===i&&1===r||(e+="scale("+String(i)+","+String(r)+")"),e},ieTransform:function(t,i,r,e,o){var s,a,n,d,p,h,g,l,m,f,c,u=this.ieFilters;t||1!==i||1!==r?(n=(s=Math.cos(t))*i,d=-(a=Math.sin(t))*r,p=a*i,h=s*r,c="progid:DXImageTransform.Microsoft.Matrix(M11="+String(n)+",M12="+String(d)+",M21="+String(p)+",M22="+String(h)+',SizingMethod="auto expand",FilterType="nearest neighbor")',m=n*(g=this.halfWidth-e)+d*(l=this.halfHeight-o),f=p*g+h*l,u.transformedCenterx=m+e,u.transformedCentery=f+o):(c="",u.transformedCenterx=0,u.transformedCentery=0),this.ieFilters.matrix=c},ieAlpha:function(t){var i;i=1!==t?"progid:DXImageTransform.Microsoft.Alpha(opacity="+String(Math.round(100*t))+")":"",this.ieFilters.alpha=i},applyIeFilters:function(t,i){var r,e,o=this.dom,s=this.options,a=this.ieFilters,n=a.matrix,d=Math.round;o.css("filter",n+a.alpha+a.gradient+a.image),n?(r=o.width(),e=o.height(),s.posOffsetX=-d(a.transformedCenterx-r/2),s.posOffsetY=-d(a.transformedCentery-e/2)):(s.posOffsetX=0,s.posOffsetY=0),o.css({left:String(t-s.posOffsetX)+"px",top:String(i-s.posOffsetY)+"px"})}}),r.PSprite=i.pick(i.PSprite,["init","remove"]),t.extend(i.PSprite,{init:function(t,i,e){r.PSprite.init.apply(this,arguments),this.old_options={}},remove:function(){this.dom&&this.dom.remove(),r.PSprite.remove.apply(this,arguments)},draw:function(r){var e,o,s,a,n=Math.round,d=this.options,p=this.old_options,h=this.parent,g=d.currentSpriteSheet,l=d.currentFrame,m=d.animation,f=this.dom,c=this.left,u=this.top,S=this.width,b=this.height,x=this.prevLeft,v=this.prevTop,M=d.multix,y=d.multiy,k=d.transformOriginx,R=d.transformOriginy,T=d.angle,C=d.scaleh,_=d.scalev,O=d.alpha,z=d.hidden,w=d.blendMode,L={},F=!1,B=!1,G=i.support,I=G.transformFunction,P=G.transformOrigin,U=G.ieFilter,A=!1,D=i.last_sprite;c===x&&u===v||((s=i.frameCounter-1)!==this.frameCounterLastMove?(this.prevLeft=c,this.prevTop=u,this.frameCounterLastMove=s):(u=n(u*r+v*(1-r)),c=n(c*r+x*(1-r)))),(a=i.insidePlayground(c,u,S,b))&&m&&O&&C&&_&&!d.hidden?(f?D!==p.last_sprite&&(f.detach(),D===h?f.prependTo(i.s[h].dom):f.insertAfter(i.s[D].dom),p.last_sprite=D):((f=t('<div id="'+i.domPrefix+this.name+'"></div>')).addClass(i.cssClass),D===h?f.prependTo(i.s[h].dom):f.insertAfter(i.s[D].dom),p.last_sprite=D,this.dom=f,U&&(this.ieFilters={matrix:"",alpha:"",gradient:"",image:""})),i.last_sprite=this.name,a!==p.insidePlayground&&(f.show(),p.insidePlayground=a),z!==p.hidden&&(f.show(),p.hidden=z),c!==p.left&&(L.left=String(c-d.posOffsetX)+"px",F=!0,p.left=c),u!==p.top&&(L.top=String(u-d.posOffsetY)+"px",F=!0,p.top=u),(o=(e=this.animation_options.frameset[g]).imageURL)!==p.imageURL&&(L["background-image"]='url("'+o+'")',F=!0,B=!0,p.imageURL=o),m!==p.animation&&(t.extend(L,{width:String(S)+"px",height:String(b)+"px"}),F=!0,B=!0,U&&(T||1!==C||1!==_)&&(A=!0),p.animation=m),M===p.multix&&y===p.multiy||(B=!0,p.multix=M,p.multiy=y),(B||g!==p.currentSpriteSheet||l!==p.currentFrame)&&(L["background-position"]=String(-(e.offsetx+M+l*e.deltax))+"px "+String(-(e.offsety+y+l*e.deltay))+"px",F=!0,p.currentSpriteSheet=g,p.currentFrame=l),"string"==typeof k&&(k=this[k]),"string"==typeof R&&(R=this[R]),!I&&U?k===p.transformOriginx&&R===p.transformOriginy&&T===p.angle&&C===p.scaleh&&_===p.scalev||(p.scaleh&&p.scalev||f.show(),this.ieTransform(T,C,_,k,R),F=!0,A=!0,p.transformOriginx=k,p.transformOriginy=R,p.angle=T,p.scaleh=C,p.scalev=_):(k===p.transformOriginx&&R===p.transformOriginy||(P&&(L[P]=k+"px "+R+"px",F=!0),p.transformOriginx=k,p.transformOriginy=R),T===p.angle&&C===p.scaleh&&_===p.scalev||(p.scaleh&&p.scalev||f.show(),I&&(L[I]=this.transform(T,C,_),F=!0),p.angle=T,p.scaleh=C,p.scalev=_)),O!==p.alpha&&(p.alpha||f.show(),G.opacity?(L[G.opacity]=1!==O?String(O):"",F=!0):U?(this.ieAlpha(O),F=!0,A=!0):t.noop(),p.alpha=O),w!==p.blendMode&&(G.mixBlendMode&&(L[G.mixBlendMode]=w||"",F=!0),p.blendMode=w),F&&f.css(L),U&&A&&this.applyIeFilters(c,u)):f&&(i.last_sprite=this.name,a||a===p.insidePlayground||(f.hide(),p.insidePlayground=a),m||m===p.animation||(f.css({"background-image":"","background-position":""}),p.imageURL=null,p.animation=m),z&&z!==p.hidden&&(f.hide(),p.hidden=z),O||O===p.alpha||(f.hide(),p.alpha=O),C||C===p.scaleh||(f.hide(),p.scaleh=C),_||_===p.scalev||(f.hide(),p.scalev=_))}}),r.PSpriteGroup=i.pick(i.PSpriteGroup,["init","remove","draw"]),t.extend(i.PSpriteGroup,{init:function(e,o,s){var a;this.old_options={},s||((a=t('<div id="'+i.domPrefix+e+'"></div>').prependTo(t(o.parentDOM))).addClass(i.cssClass),a.css({left:"0px",top:"0px",width:String(o.width)+"px",height:String(o.height)+"px",overflow:"hidden"}),this.old_options.last_sprite=e,this.dom=a,a.get(0).filters?(i.support.ieFilter=!0,this.ieFilters={matrix:"",alpha:"",gradient:"",image:""}):i.support.ieFilter=!1),r.PSpriteGroup.init.apply(this,arguments)},remove:function(){r.PSpriteGroup.remove.apply(this,arguments),this.dom&&this.dom.remove()},draw:function(e){var o,s=Math.round,a=this.options,n=this.old_options,d=this.parent,p=this.left,h=this.top,g=this.width,l=this.height,m=this.prevLeft,f=this.prevTop,c=a.background,u=a.backgroundType,S=a.mask,b=a.maskType,x=a.hasBorder,v=a.borderTopLeftRadius,M=a.borderTopRightRadius,y=a.borderBottomRightRadius,k=a.borderBottomLeftRadius,R=x&&a.borderWidth||0,T=x&&a.borderColor,C=R!==n.borderWidth,_=a.transformOriginx,O=a.transformOriginy,z=a.angle,w=a.scaleh,L=a.scalev,F=a.alpha,B=a.hidden,G=a.crop,I=a.blendMode,P={},U=!1,A=this.dom,D=i.support,X=D.transformFunction,E=D.transformOrigin,H=D.ieFilter,N=H&&this.ieFilters,W=!1,Y=i.last_sprite,K=this.name;d||(Y=K,i.last_sprite=Y),p===m&&h===f||((o=i.frameCounter-1)!==this.frameCounterLastMove?(this.prevLeft=p,this.prevTop=h,this.frameCounterLastMove=o):(h=s(h*e+f*(1-e)),p=s(p*e+m*(1-e)))),(this.layers.length||c||T)&&F&&w&&L&&!a.hidden?(this.dom?Y!==n.last_sprite&&(A.detach(),Y===d?A.prependTo(i.s[d].dom):A.insertAfter(i.s[Y].dom),n.last_sprite=Y):((A=t('<div id="'+i.domPrefix+this.name+'"></div>')).addClass(i.cssClass),Y===d?A.prependTo(i.s[d].dom):A.insertAfter(i.s[Y].dom),n.last_sprite=Y,this.dom=A,H&&(this.ieFilters={matrix:"",alpha:"",gradient:"",image:""},N=this.ieFilters)),i.last_sprite=this.name,B!==n.hidden&&(A.show(),n.hidden=B),(p!==n.left||C)&&(P.left=String(p-a.posOffsetX-R)+"px",U=!0,n.left=p),(h!==n.top||C)&&(P.top=String(h-a.posOffsetY-R)+"px",U=!0,n.top=h),g!==n.width&&(P.width=String(g)+"px",U=!0,H&&(z||1!==w||1!==L)&&(W=!0),n.width=g),l!==n.height&&(P.height=String(l)+"px",U=!0,H&&(z||1!==w||1!==L)&&(W=!0),n.height=l),"string"==typeof _&&(_=this[_]),"string"==typeof O&&(O=this[O]),!X&&H?_===n.transformOriginx&&O===n.transformOriginy&&z===n.angle&&w===n.scaleh&&L===n.scalev||(n.scaleh&&n.scalev||A.show(),this.ieTransform(z,w,L,_,O),U=!0,W=!0,n.transformOriginx=_,n.transformOriginy=O,n.angle=z,n.scaleh=w,n.scalev=L):(_===n.transformOriginx&&O===n.transformOriginy||(E&&(P[E]=_+"px "+O+"px",U=!0),n.transformOriginx=_,n.transformOriginy=O),z===n.angle&&w===n.scaleh&&L===n.scalev||(n.scaleh&&n.scalev||A.show(),X&&(P[X]=this.transform(z,w,L),U=!0),n.angle=z,n.scaleh=w,n.scalev=L)),F!==n.alpha&&(n.alpha||A.show(),D.opacity?(P[D.opacity]=1!==F?String(F):"",U=!0):H?(this.ieAlpha(F),U=!0,W=!0):t.noop(),n.alpha=F),I!==n.blendMode&&(D.mixBlendMode&&(P[D.mixBlendMode]=I||"",U=!0),n.blendMode=I),c===n.background&&u===n.backgroundType||(P["background-color"]="",P["background-image"]="",D.backgroundsize&&(P[D.backgroundsize]=""),N&&N.gradient&&(N.gradient="",W=!0),N&&N.image&&(N.image="",W=!0),c&&c.getBackground(u,P,N)&&(W=!0),U=!0,n.background=c,n.backgroundType=u),S===n.mask&&b===n.maskType||(D.maskImage&&(P[D.maskImage]="",P[D.maskSize]=""),S&&S.getMask(b,P,N)&&(W=!0),U=!0,n.mask=S,n.maskType=b),D.borderTopLeftRadius&&((v!==n.borderTopLeftRadius||C)&&(P[D.borderTopLeftRadius]=v?String(v+R)+"px":"",U=!0,n.borderTopLeftRadius=v),(M!==n.borderTopRightRadius||C)&&(P[D.borderTopRightRadius]=M?String(M+R)+"px":"",U=!0,n.borderTopRightRadius=M),(y!==n.borderBottomRightRadius||C)&&(P[D.borderBottomRightRadius]=y?String(y+R)+"px":"",U=!0,n.borderBottomRightRadius=y),(k!==n.borderBottomLeftRadius||C)&&(P[D.borderBottomLeftRadius]=k?String(k+R)+"px":"",U=!0,n.borderBottomLeftRadius=k)),C&&(P["border-width"]=R?String(R)+"px":"",U=!0,n.borderWidth=R),T!==n.borderColor&&(P["border-color"]=T?T.getSolidColor():"",U=!0,n.borderWidth=R),G!==n.crop&&(d&&(P.overflow=G?"hidden":"visible",U=!0),n.crop=G),U&&A.css(P),H&&W&&this.applyIeFilters(p,h),r.PSpriteGroup.draw.apply(this,arguments),i.last_sprite=K):A&&(i.last_sprite=this.name,B&&B!==n.hidden&&(A.hide(),n.hidden=B),F||F===n.alpha||(A.hide(),n.alpha=F),w||w===n.scaleh||(A.hide(),n.scaleh=w),L||L===n.scalev||(A.hide(),n.scalev=L))}})}(jQuery,friGame);