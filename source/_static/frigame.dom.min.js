!function(i,t){"use strict";var r={};t.support={ieFilter:!1,rgba:Modernizr.rgba,svg:Modernizr.svg},Modernizr.opacity&&(t.support.opacity=Modernizr.prefixed("opacity")),Modernizr.csstransforms&&(t.support.transformFunction=Modernizr.prefixed("transform")),Modernizr.backgroundsize&&(t.support.backgroundsize=Modernizr.prefixed("backgroundSize")),Modernizr.borderradius&&(t.support.borderTopLeftRadius=Modernizr.prefixed("borderTopLeftRadius"),t.support.borderTopRightRadius=Modernizr.prefixed("borderTopRightRadius"),t.support.borderBottomRightRadius=Modernizr.prefixed("borderBottomRightRadius"),t.support.borderBottomLeftRadius=Modernizr.prefixed("borderBottomLeftRadius")),t.nextGradientId=0,i.extend(t.PGradient,{initDOM:function(){var i,r,e,o,s,n,a,d,p,h,g=this.startColor,l=this.endColor,c=t.support;this.solid_color=1===g.a?["rgb(",String(g.r),",",String(g.g),",",String(g.b),")"].join(""):c.rgba?this.startColorStr:["rgb(",String(g.r),",",String(g.g),",",String(g.b),")"].join(""),g===l?1===g.a?this.css_options={"background-color":["rgb(",String(g.r),",",String(g.g),",",String(g.b),")"].join("")}:c.rgba?this.css_options={"background-color":this.startColorStr}:c.ieFilter?(i=["0",Math.round(255*g.a).toString(16).toUpperCase()].join(""),r=["0",g.r.toString(16).toUpperCase()].join(""),e=["0",g.g.toString(16).toUpperCase()].join(""),o=["0",g.b.toString(16).toUpperCase()].join(""),s=["#",i.slice(i.length-2),r.slice(r.length-2),e.slice(e.length-2),o.slice(o.length-2)].join(""),this.ie_filter=['progid:DXImageTransform.Microsoft.Gradient(GradientType=0,startColorstr="',s,'",endColorstr="',s,'")'].join("")):this.css_options={"background-color":["rgb(",String(g.r),",",String(g.g),",",String(g.b),")"].join("")}:c.svg?(s=["rgb(",String(g.r),",",String(g.g),",",String(g.b),")"].join(""),n=["rgb(",String(l.r),",",String(l.g),",",String(l.b),")"].join(""),this.type===t.GRADIENT_HORIZONTAL?(d=100,p=0):(d=0,p=100),h=['<svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 1 1" preserveAspectRatio="none">',"<defs>",'<linearGradient id="friGameGradient',String(t.nextGradientId),'" gradientUnits="userSpaceOnUse" x1="0%" y1="0%" x2="',String(d),'%" y2="',String(p),'%">','<stop offset="0%" stop-color="',s,'" stop-opacity="',String(g.a),'" />','<stop offset="100%" stop-color="',n,'" stop-opacity="',String(l.a),'" />',"</linearGradient>","</defs>",'<rect x="0" y="0" width="1" height="1" fill="url(#friGameGradient',String(t.nextGradientId),')" />',"</svg>"].join(""),t.nextGradientId+=1,this.css_options={"background-image":['url("data:image/svg+xml;base64,',btoa(h),'")'].join("")},c.backgroundsize&&(this.css_options[c.backgroundsize]="100% 100%")):c.ieFilter?(i=["0",Math.round(255*g.a).toString(16).toUpperCase()].join(""),r=["0",g.r.toString(16).toUpperCase()].join(""),e=["0",g.g.toString(16).toUpperCase()].join(""),o=["0",g.b.toString(16).toUpperCase()].join(""),s=["#",i.slice(i.length-2),r.slice(r.length-2),e.slice(e.length-2),o.slice(o.length-2)].join(""),i=["0",Math.round(255*l.a).toString(16).toUpperCase()].join(""),r=["0",l.r.toString(16).toUpperCase()].join(""),e=["0",l.g.toString(16).toUpperCase()].join(""),o=["0",l.b.toString(16).toUpperCase()].join(""),n=["#",i.slice(i.length-2),r.slice(r.length-2),e.slice(e.length-2),o.slice(o.length-2)].join(""),a=this.type===t.GRADIENT_HORIZONTAL?1:0,this.ie_filter=["progid:DXImageTransform.Microsoft.Gradient(GradientType=",a,',startColorstr="',s,'",endColorstr="',n,'")'].join("")):this.css_options={"background-color":this.solid_color},this.dom_initialized=!0},getBackground:function(t,r,e){var o=!1;return this.dom_initialized||this.initDOM(),this.css_options&&i.extend(r,this.css_options),this.ie_filter&&(e.gradient=this.ie_filter,o=!0),o},getSolidColor:function(){return this.dom_initialized||this.initDOM(),this.solid_color}}),i.extend(t.PAnimation,{getBackground:function(i,r,e){var o=t.support,s=!1,n=this.options.frameset[0].imageURL;return i===t.BACKGROUND_STRETCHED?o.backgroundsize?(r["background-image"]=['url("',n,'")'].join(""),r[o.backgroundsize]="100% 100%"):o.ieFilter?(e.image=['progid:DXImageTransform.Microsoft.AlphaImageLoader(src="',n,'",sizingMethod="scale")'].join(""),s=!0):r["background-image"]=['url("',n,'")'].join(""):r["background-image"]=['url("',n,'")'].join(""),s}}),i.extend(t.PBaseSprite,{transform:function(){var i=this.options,t=i.angle,r=i.scaleh,e=i.scalev,o=[];return t&&Array.prototype.push.apply(o,["rotate(",String(t),"rad)"]),(1!==r||1!==e)&&Array.prototype.push.apply(o,["scale(",String(r),",",String(e),")"]),o.join("")},ieTransform:function(){var i,t,r,e=this.options,o=e.angle,s=e.scaleh,n=e.scalev;o||1!==s||1!==n?(i=Math.cos(o),t=Math.sin(o),r=["progid:DXImageTransform.Microsoft.Matrix(M11=",String(i*s),",M12=",String(-t*n),",M21=",String(t*s),",M22=",String(i*n),',SizingMethod="auto expand",FilterType="nearest neighbor")'].join("")):r="",this.ieFilters.matrix=r},ieAlpha:function(){var i,t=this.options.alpha;i=1!==t?["progid:DXImageTransform.Microsoft.Alpha(opacity=",String(Math.round(100*t)),")"].join(""):"",this.ieFilters.alpha=i},applyIeFilters:function(){var i,t,r=this.dom,e=this.options,o=this.ieFilters,s=Math.round;r.css("filter",[o.matrix,o.alpha,o.gradient,o.image].join("")),i=r.width(),t=r.height(),e.posOffsetX=s((i-this.width)/2),e.posOffsetY=s((t-this.height)/2),r.css({left:[String(this.left-e.posOffsetX),"px"].join(""),top:[String(this.top-e.posOffsetY),"px"].join("")})}}),r.PSprite=t.pick(t.PSprite,["init","remove"]),i.extend(t.PSprite,{init:function(){r.PSprite.init.apply(this,arguments),this.old_options={}},remove:function(){this.dom&&this.dom.remove(),r.PSprite.remove.apply(this,arguments)},draw:function(){var r,e,o=this.options,s=this.old_options,n=this.parent,a=o.currentSpriteSheet,d=o.currentFrame,p=o.animation,h=t.insidePlayground(this),g=this.dom,l=this.left,c=this.top,u=o.multix,m=o.multiy,f=o.angle,S=o.scaleh,b=o.scalev,x=o.alpha,j=o.hidden,v={},R=!1,y=!1,_=t.support,T=_.transformFunction,M=_.ieFilter,k=!1,C=t.last_sprite;h&&p&&x&&S&&b&&!o.hidden?(g?C!==s.last_sprite&&(g.detach(),C===n?g.prependTo(t.s[n].dom):g.insertAfter(t.s[C].dom),s.last_sprite=C):(g=i(['<div id="',t.domPrefix,this.name,'"></div>'].join("")),g.addClass(t.cssClass),C===n?g.prependTo(t.s[n].dom):g.insertAfter(t.s[C].dom),s.last_sprite=C,this.dom=g,M&&(this.ieFilters={matrix:"",alpha:"",gradient:"",image:""})),t.last_sprite=this.name,h!==s.insidePlayground&&(g.show(),s.insidePlayground=h),j!==s.hidden&&(g.show(),s.hidden=j),l!==s.left&&(v.left=[String(l-o.posOffsetX),"px"].join(""),R=!0,s.left=l),c!==s.top&&(v.top=[String(c-o.posOffsetY),"px"].join(""),R=!0,s.top=c),r=this.animation_options.frameset[a],e=r.imageURL,e!==s.imageURL&&(v["background-image"]=['url("',e,'")'].join(""),R=!0,y=!0,s.imageURL=e),p!==s.animation&&(i.extend(v,{width:[String(this.width),"px"].join(""),height:[String(this.height),"px"].join("")}),R=!0,y=!0,M&&(f||1!==S||1!==b)&&(k=!0),s.animation=p),(u!==s.multix||m!==s.multiy)&&(y=!0,s.multix=u,s.multiy=m),(y||a!==s.currentSpriteSheet||d!==s.currentFrame)&&(v["background-position"]=[String(-(r.offsetx+u+d*r.deltax)),"px ",String(-(r.offsety+m+d*r.deltay)),"px"].join(""),R=!0,s.currentSpriteSheet=a,s.currentFrame=d),(f!==s.angle||S!==s.scaleh||b!==s.scalev)&&(s.scaleh&&s.scalev||g.show(),T?(v[T]=this.transform(),R=!0):M?(this.ieTransform(),R=!0,k=!0):i.noop(),s.angle=f,s.scaleh=S,s.scalev=b),x!==s.alpha&&(s.alpha||g.show(),_.opacity?(v[_.opacity]=1!==x?String(x):"",R=!0):M?(this.ieAlpha(),R=!0,k=!0):i.noop(),s.alpha=x),R&&g.css(v),M&&k&&this.applyIeFilters()):g&&(t.last_sprite=this.name,h||h===s.insidePlayground||(g.hide(),s.insidePlayground=h),p||p===s.animation||(g.css({"background-image":"","background-position":""}),s.imageURL=null,s.animation=p),j&&j!==s.hidden&&(g.hide(),s.hidden=j),x||x===s.alpha||(g.hide(),s.alpha=x),S||S===s.scaleh||(g.hide(),s.scaleh=S),b||b===s.scalev||(g.hide(),s.scalev=b))}}),r.PSpriteGroup=t.pick(t.PSpriteGroup,["init","remove","draw"]),i.extend(t.PSpriteGroup,{init:function(e,o,s){var n;this.old_options={},s||(n=i(['<div id="',t.domPrefix,e,'"></div>'].join("")).prependTo(i(o.parentDOM)),n.addClass(t.cssClass),n.css({left:"0px",top:"0px",width:[String(o.width),"px"].join(""),height:[String(o.height),"px"].join(""),overflow:"hidden"}),this.old_options.last_sprite=e,this.dom=n,n.get(0).filters?(t.support.ieFilter=!0,this.ieFilters={matrix:"",alpha:"",gradient:"",image:""}):t.support.ieFilter=!1),r.PSpriteGroup.init.apply(this,arguments)},remove:function(){r.PSpriteGroup.remove.apply(this,arguments),this.dom&&this.dom.remove()},draw:function(){var e=this.options,o=this.old_options,s=this.parent,n=this.left,a=this.top,d=this.width,p=this.height,h=e.background,g=e.backgroundType,l=e.hasBorder,c=e.borderTopLeftRadius,u=e.borderTopRightRadius,m=e.borderBottomRightRadius,f=e.borderBottomLeftRadius,S=l&&e.borderWidth||0,b=l&&e.borderColor,x=S!==o.borderWidth,j=e.angle,v=e.scaleh,R=e.scalev,y=e.alpha,_=e.hidden,T=e.crop,M={},k=!1,C=this.dom,w=t.support,z=w.transformFunction,F=w.ieFilter,G=F&&this.ieFilters,P=!1,L=t.last_sprite,U=this.name;s||(L=U,t.last_sprite=L),(this.layers.length||h||b)&&y&&v&&R&&!e.hidden?(this.dom?L!==o.last_sprite&&(C.detach(),L===s?C.prependTo(t.s[s].dom):C.insertAfter(t.s[L].dom),o.last_sprite=L):(C=i(['<div id="',t.domPrefix,this.name,'"></div>'].join("")),C.addClass(t.cssClass),L===s?C.prependTo(t.s[s].dom):C.insertAfter(t.s[L].dom),o.last_sprite=L,this.dom=C,F&&(this.ieFilters={matrix:"",alpha:"",gradient:"",image:""},G=this.ieFilters)),t.last_sprite=this.name,_!==o.hidden&&(C.show(),o.hidden=_),(n!==o.left||x)&&(M.left=[String(n-e.posOffsetX-S),"px"].join(""),k=!0,o.left=n),(a!==o.top||x)&&(M.top=[String(a-e.posOffsetY-S),"px"].join(""),k=!0,o.top=a),d!==o.width&&(M.width=[String(d),"px"].join(""),k=!0,F&&(j||1!==v||1!==R)&&(P=!0),o.width=d),p!==o.height&&(M.height=[String(p),"px"].join(""),k=!0,F&&(j||1!==v||1!==R)&&(P=!0),o.height=p),(j!==o.angle||v!==o.scaleh||R!==o.scalev)&&(o.scaleh&&o.scalev||C.show(),z?(M[z]=this.transform(),k=!0):F?(this.ieTransform(),k=!0,P=!0):i.noop(),o.angle=j,o.scaleh=v,o.scalev=R),y!==o.alpha&&(o.alpha||C.show(),w.opacity?(M[w.opacity]=1!==y?String(y):"",k=!0):F?(this.ieAlpha(),k=!0,P=!0):i.noop(),o.alpha=y),(h!==o.background||g!==o.backgroundType)&&(M["background-color"]="",M["background-image"]="",w.backgroundsize&&(M[w.backgroundsize]=""),G&&G.gradient&&(G.gradient="",P=!0),G&&G.image&&(G.image="",P=!0),h&&h.getBackground(g,M,G)&&(P=!0),k=!0,o.background=h,o.backgroundType=g),w.borderTopLeftRadius&&((c!==o.borderTopLeftRadius||x)&&(M[w.borderTopLeftRadius]=c?[String(c+S),"px"].join(""):"",k=!0,o.borderTopLeftRadius=c),(u!==o.borderTopRightRadius||x)&&(M[w.borderTopRightRadius]=u?[String(u+S),"px"].join(""):"",k=!0,o.borderTopRightRadius=u),(m!==o.borderBottomRightRadius||x)&&(M[w.borderBottomRightRadius]=m?[String(m+S),"px"].join(""):"",k=!0,o.borderBottomRightRadius=m),(f!==o.borderBottomLeftRadius||x)&&(M[w.borderBottomLeftRadius]=f?[String(f+S),"px"].join(""):"",k=!0,o.borderBottomLeftRadius=f)),x&&(M["border-width"]=S?[String(S),"px"].join(""):"",k=!0,o.borderWidth=S),b!==o.borderColor&&(M["border-color"]=b?b.getSolidColor():"",k=!0,o.borderWidth=S),T!==o.crop&&(s&&(M.overflow=T?"hidden":"visible",k=!0),o.crop=T),k&&C.css(M),F&&P&&this.applyIeFilters(),r.PSpriteGroup.draw.apply(this,arguments),t.last_sprite=U):C&&(t.last_sprite=this.name,_&&_!==o.hidden&&(C.hide(),o.hidden=_),y||y===o.alpha||(C.hide(),o.alpha=y),v||v===o.scaleh||(C.hide(),o.scaleh=v),R||R===o.scalev||(C.hide(),o.scalev=R))}})}(jQuery,friGame);